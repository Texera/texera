<div> 
    <nz-card>
        <h2 class="project-title">Project : {{name}}</h2>
        <nz-card-meta nzDescription="Created: {{creationTime | date: 'yyyy-MM-dd HH:mm'}}"></nz-card-meta>
    </nz-card>

    <nz-card> 
        <h2>Workflows</h2> 
        <button
            (click)="onClickOpenAddWorkflow()"
            nz-button
            nz-tooltip="Add workflow(s) to project"
            nzTooltipPlacement="bottom"
            type="button"
        >
            <i nz-icon nzTheme="outline" nzType="plus-square"></i>
        </button>
        <button
            (click)="onClickOpenRemoveWorkflow()"
            nz-button
            nz-tooltip="Remove workflow(s) from project"
            nzTooltipPlacement="bottom"
            type="button"
        >
            <i nz-icon nzTheme="outline" nzType="minus-square"></i>
        </button>
    </nz-card>

    <nz-card class="workflow-list-container subsection-grid-container">
        <nz-list>
            <nz-list-item 
              *ngFor="let workflow of workflows;let i = index"
              class="workflow-list-item"
            >
                <nz-list-item-meta>
                    <nz-list-item-meta-avatar>
                        <nz-avatar
                          [ngStyle]="{ 'background-color': 'grey' }"
                          [nzGap]="4"
                          [nzText]="'' + workflow.workflow.wid"
                          nzSize="medium"
                          style="vertical-align: middle"
                        ></nz-avatar>
                    </nz-list-item-meta-avatar>
                    <nz-list-item-meta-title>
                        <span class="workflow-dashboard-entry">
                            <label
                            *ngIf="isEditingWorkflowName.indexOf(i) === -1; else editWorkflowName"
                            (click)="jumpToWorkflow(workflow)"
                            class="workflow-name"
                            >
                                {{workflow.workflow.name}}
                            </label>
                            <ng-template #editWorkflowName>
                                <input
                                #editWorkflowName
                                (focusout)="confirmEditWorkflowName(workflow, editWorkflowName.value, i)"
                                (keyup.enter)="confirmEditWorkflowName(workflow, editWorkflowName.value, i)"
                                placeholder="{{ workflow.workflow.name }}"
                                value="{{ workflow.workflow.name }}"
                                />
                            </ng-template>
                            <button
                            (click)="isEditingWorkflowName.push(i)"
                            nz-button
                            nz-tooltip="Edit Workflow Name"
                            nzSize="small"
                            nzTooltipPlacement="bottom"
                            nzType="text"
                            >
                                <i nz-icon nzTheme="outline" nzType="edit"></i>
                            </button>
                            <i
                            *ngIf="workflow.isOwner"
                            ngbTooltip="You are the OWNER"
                            nz-icon
                            nzTheme="outline"
                            nzType="user"
                            ></i>
                            <i
                            *ngIf="!workflow.isOwner"
                            ngbTooltip="{{workflow.accessLevel}} access shared by {{workflow.ownerName}}"
                            nz-icon
                            nzTheme="outline"
                            nzType="team"
                            ></i>
                        </span>
                    </nz-list-item-meta-title>
                    <nz-list-item-meta-description>
                        <p class="workflow-time">
                            Last Access: {{ workflow.workflow.lastModifiedTime | date: "yyyy-MM-dd HH:mm" }}
                            <span class="time-space"></span>
                            Created: {{ workflow.workflow.creationTime | date: "yyyy-MM-dd HH:mm" }}
                        </p>
                    </nz-list-item-meta-description>
                </nz-list-item-meta>
                <ul nz-list-item-actions>
                    <nz-list-item-action>
                        <button
                          (click)="onClickOpenShareAccess(workflow)"
                          [disabled]="!workflow.isOwner"
                          nz-button
                          nz-tooltip="Share the workflow {{workflow.workflow.name}} to others"
                          nzTooltipPlacement="bottom"
                          type="button"
                        >
                            <i nz-icon nzTheme="outline" nzType="share-alt"></i>
                        </button>
                    </nz-list-item-action>
                    <nz-list-item-action>
                        <button
                          (click)="onClickDuplicateWorkflow(workflow)"
                          nz-button
                          nz-tooltip="Duplicate the workflow {{workflow.workflow.name}}"
                          nzTooltipPlacement="bottom"
                          type="button"
                        >
                            <i nz-icon nzTheme="outline" nzType="copy"></i>
                        </button>
                    </nz-list-item-action>
                    <nz-list-item-action>
                        <button
                          (click)="onClickDeleteWorkflow(workflow)"
                          [disabled]="!workflow.isOwner"
                          nz-button
                          nz-tooltip="Delete the workflow {{workflow.workflow.name}}"
                          nzTooltipPlacement="bottom"
                        >
                            <i nz-icon nzTheme="outline" nzType="delete"></i>
                        </button>
                    </nz-list-item-action>
                </ul>
            </nz-list-item>
        </nz-list>
    </nz-card>
</div>

<div> 
    <nz-card> 
        <h2>Files</h2> 
        <button
            (click)="onClickOpenAddFile()"
            nz-button
            nz-tooltip="Add file(s) to project"
            nzTooltipPlacement="bottom"
            type="button"
        >
            <i nz-icon nzTheme="outline" nzType="plus-square"></i>
        </button>
        <button
            (click)="onClickOpenRemoveFile()"
            nz-button
            nz-tooltip="Remove workflow(s) from project"
            nzTooltipPlacement="bottom"
            type="button"
        >
            <i nz-icon nzTheme="outline" nzType="minus-square"></i>
        </button>
    </nz-card>

    <nz-card>
        <nz-list>
            <nz-list-item *ngFor="let file of getUserProjectFilesArray(); let i=index">
                <nz-list-item-meta>
                    <nz-list-item-meta-title>
                        <div class="file-name">
                            <h4 *ngIf="isEditingFileName.indexOf(i) === -1; else editFileName" class="file-title">
                                {{file.ownerName + "/" + file.file.name}}
                            </h4>
                            <ng-template #editFileName>
                                <input
                                  #editFileName
                                  (focusout)="confirmEditFileName(file, editFileName.value, i)"
                                  (keyup.enter)="confirmEditFileName(file, editFileName.value, i)"
                                  placeholder="{{file.file.name}}"
                                  value="{{file.file.name}}"
                                />
                            </ng-template>
                            <button
                              (click)="isEditingFileName.push(i)"
                              nz-button
                              nz-tooltip="Edit File Name"
                              nzSize="small"
                              nzTooltipPlacement="bottom"
                              nzType="text"
                            >
                                <i nz-icon nzTheme="outline" nzType="edit"></i>
                            </button>
                            <i
                              *ngIf="file.isOwner"
                              ngbTooltip="You are the OWNER"
                              nz-icon
                              nzTheme="outline"
                              nzType="user"
                            ></i>
                            <i
                              *ngIf="!file.isOwner"
                              ngbTooltip="{{file.accessLevel}} access shared by {{file.ownerName}}"
                              nz-icon
                              nzTheme="outline"
                              nzType="team"
                            ></i>
                        </div>
                    </nz-list-item-meta-title>
                    <nz-list-item-meta-description>
                        {{addFileSizeUnit(file.file.size)}}
                    </nz-list-item-meta-description>
                </nz-list-item-meta>
                <ul nz-list-item-actions>
                    <nz-list-item-action>
                        <button
                          (click)="onClickOpenFileShareAccess(file)"
                          [disabled]="file.accessLevel !== 'Write'"
                          nz-button
                          nz-tooltip="Share the file {{file.file.name}} to others"
                          nzTooltipPlacement="bottom"
                          type="button"
                        >
                            <i nz-icon nzTheme="outline" nzType="share-alt"></i>
                        </button>
                    </nz-list-item-action>
                    <nz-list-item-action>
                        <button
                          (click)="downloadUserFile(file)"
                          nz-button
                          nz-tooltip="Download the file {{file.file.name}}"
                          nzTooltipPlacement="bottom"
                        >
                            <i nz-icon nzTheme="outline" nzType="download"></i>
                        </button>
                    </nz-list-item-action>
                    <nz-list-item-action>
                        <button
                          (click)="deleteUserFileEntry(file)"
                          [disabled]="file.accessLevel !== 'Write'"
                          nz-button
                          nz-tooltip="Delete the file {{file.file.name}}"
                          nzTooltipPlacement="bottom"
                          type="button"
                        >
                            <i nz-icon nzTheme="outline" nzType="delete"></i>
                        </button>
                    </nz-list-item-action>
                </ul>
            </nz-list-item>
        </nz-list>
    </nz-card>
</div>