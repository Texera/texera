<nz-select
  nzSize="large"
  nzShowSearch
  [nzDropdownRender]="renderTemplate"
  nzPlaceHolder="Select a computing unit"
  [(ngModel)]="selectedComputingUnit"
  (ngModelChange)="onComputingUnitChange($event)">
  <nz-option
    *ngFor="let unit of computingUnits"
    nzCustomContent
    [nzLabel]="unit.uri"
    [nzValue]="unit">
    <div class="computing-unit-option">
      <!-- Badge with state -->
      <nz-badge
        [nzColor]="getBadgeColor(unit.status)"
        [nzText]="''">
        <span
          class="unit-type"
          nz-icon
          nzType="desktop"></span>
      </nz-badge>

      <!-- Name and tooltip -->
      <span class="unit-details">
        <span
          nz-tooltip
          [nzTooltipTitle]="unit.uri"
          >{{ unit.computingUnit.name }}</span
        >
        <div
          *ngIf="environment.computingUnitManagerEnabled"
          class="terminate-box"
          nz-tooltip
          [nzTooltipTitle]="'Terminate'"
          (click)="terminateComputingUnit(unit.computingUnit.cuid)"></div>
      </span>
    </div>
  </nz-option>
</nz-select>

<ng-template #renderTemplate>
  <div
    *ngIf="environment.computingUnitManagerEnabled"
    class="dropdown-footer">
    <button
      nz-button
      nzType="primary"
      nzBlock
      (click)="startComputingUnit()">
      Start
    </button>
  </div>
</ng-template>
