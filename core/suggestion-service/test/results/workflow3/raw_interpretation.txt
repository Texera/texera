{"workflow":{"operators":{"CSVFileScan-operator-7249c7e8-6d05-4572-931e-495d47f7ccf1":{"operatorID":"CSVFileScan-operator-7249c7e8-6d05-4572-931e-495d47f7ccf1","operatorType":"CSVFileScan","customDisplayName":"CSV File Scan","operatorProperties":{"fileEncoding":"UTF_8","customDelimiter":",","hasHeader":true,"fileName":"/workflow_migrator@texera/ds4all-lecture-example/v1/clean_tweets.csv"},"error":null,"inputSchemas":{}},"Projection-operator-fa6c76fa-3208-4f20-9b44-f920b91e898c":{"operatorID":"Projection-operator-fa6c76fa-3208-4f20-9b44-f920b91e898c","operatorType":"Projection","customDisplayName":"Projection","operatorProperties":{"isDrop":false,"attributes":[{"alias":"","originalAttribute":"tweet_id"},{"alias":"","originalAttribute":"create_at_month"},{"alias":"","originalAttribute":"favorite_count"},{"alias":"","originalAttribute":"retweet_count"}]},"error":null,"inputSchemas":{"input-0":{"portID":"input-0","inputSchema":{"attributes":[{"attributeName":"favorite_count","attributeType":"integer"},{"attributeName":"tweet_id","attributeType":"integer"},{"attributeName":"retweet_count","attributeType":"integer"},{"attributeName":"user_id","attributeType":"integer"},{"attributeName":"text","attributeType":"string"},{"attributeName":"lang","attributeType":"string"},{"attributeName":"create_at_month","attributeType":"timestamp"},{"attributeName":"is_retweet","attributeType":"boolean"}]}}}},"Sort-operator-3985eaf1-5af2-4f4a-bd0f-1c4b3f7e78c2":{"operatorID":"Sort-operator-3985eaf1-5af2-4f4a-bd0f-1c4b3f7e78c2","operatorType":"Sort","customDisplayName":"Sort","operatorProperties":{"attributes":[{"attribute":"favorite_count","sortPreference":"DESC"}]},"error":null,"inputSchemas":{"input-0":{"portID":"input-0","inputSchema":{"attributes":[{"attributeName":"create_at_month","attributeType":"timestamp"},{"attributeName":"favorite_count","attributeType":"integer"},{"attributeName":"tweet_id","attributeType":"integer"},{"attributeName":"retweet_count","attributeType":"integer"}]}}}},"Projection-operator-9e443d52-a201-4f43-88fc-d8ad2cf4eb16":{"operatorID":"Projection-operator-9e443d52-a201-4f43-88fc-d8ad2cf4eb16","operatorType":"Projection","customDisplayName":"Projection","operatorProperties":{"isDrop":false,"attributes":[{"alias":"","originalAttribute":"text"}]},"error":null,"inputSchemas":{"input-0":{"portID":"input-0","inputSchema":{"attributes":[{"attributeName":"favorite_count","attributeType":"integer"},{"attributeName":"tweet_id","attributeType":"integer"},{"attributeName":"retweet_count","attributeType":"integer"},{"attributeName":"user_id","attributeType":"integer"},{"attributeName":"text","attributeType":"string"},{"attributeName":"lang","attributeType":"string"},{"attributeName":"create_at_month","attributeType":"timestamp"},{"attributeName":"is_retweet","attributeType":"boolean"}]}}}},"PythonUDFV2-operator-3e3c9f53-dae3-4dc4-b724-7ffdb8e7b80c":{"operatorID":"PythonUDFV2-operator-3e3c9f53-dae3-4dc4-b724-7ffdb8e7b80c","operatorType":"PythonUDFV2","customDisplayName":"Python UDF","operatorProperties":{"code":"# Choose from the following templates:\n# \nfrom pytexera import *\n\nclass ProcessTupleOperator(UDFOperatorV2):\n    \n    @overrides\n    def process_tuple(self, tuple_: Tuple, port: int) -> Iterator[Optional[TupleLike]]:\n        tuple_['text_length'] = len(tuple_['text'])\n        yield tuple_\n\n# class ProcessBatchOperator(UDFBatchOperator):\n#     BATCH_SIZE = 10 # must be a positive integer\n# \n#     @overrides\n#     def process_batch(self, batch: Batch, port: int) -> Iterator[Optional[BatchLike]]:\n#         yield batch\n# \n# class ProcessTableOperator(UDFTableOperator):\n# \n#     @overrides\n#     def process_table(self, table: Table, port: int) -> Iterator[Optional[TableLike]]:\n#         yield table\n","workers":1,"retainInputColumns":true,"outputColumns":[{"attributeName":"text_length","attributeType":"integer"}]},"error":null,"inputSchemas":{"input-0":{"portID":"input-0","inputSchema":{"attributes":[{"attributeName":"text","attributeType":"string"}]}}}},"LineChart-operator-e3009841-32e4-4080-a6e4-f659762b3865":{"operatorID":"LineChart-operator-e3009841-32e4-4080-a6e4-f659762b3865","operatorType":"LineChart","customDisplayName":"Line Chart","operatorProperties":{"yLabel":"Y Axis","xLabel":"X Axis"},"error":{"type":"COMPILATION_ERROR","message":"java.lang.RuntimeException: Operator is not configured properly: null","details":"Stack trace for developers: \n\njava.lang.RuntimeException: Operator is not configured properly: null\nedu.uci.ics.amber.compiler.WorkflowCompiler.$anonfun$expandLogicalPlan$9(WorkflowCompiler.scala:149)"},"inputSchemas":{"input-0":{"portID":"input-0","inputSchema":{"attributes":[{"attributeName":"create_at_month","attributeType":"timestamp"},{"attributeName":"favorite_count","attributeType":"integer"},{"attributeName":"tweet_id","attributeType":"integer"},{"attributeName":"retweet_count","attributeType":"integer"}]}}}}},"links":[{"source":{"operatorID":"CSVFileScan-operator-7249c7e8-6d05-4572-931e-495d47f7ccf1","portID":"output-0"},"target":{"operatorID":"Projection-operator-fa6c76fa-3208-4f20-9b44-f920b91e898c","portID":"input-0"}},{"source":{"operatorID":"Projection-operator-fa6c76fa-3208-4f20-9b44-f920b91e898c","portID":"output-0"},"target":{"operatorID":"Sort-operator-3985eaf1-5af2-4f4a-bd0f-1c4b3f7e78c2","portID":"input-0"}},{"source":{"operatorID":"CSVFileScan-operator-7249c7e8-6d05-4572-931e-495d47f7ccf1","portID":"output-0"},"target":{"operatorID":"Projection-operator-9e443d52-a201-4f43-88fc-d8ad2cf4eb16","portID":"input-0"}},{"source":{"operatorID":"Projection-operator-9e443d52-a201-4f43-88fc-d8ad2cf4eb16","portID":"output-0"},"target":{"operatorID":"PythonUDFV2-operator-3e3c9f53-dae3-4dc4-b724-7ffdb8e7b80c","portID":"input-0"}},{"source":{"operatorID":"Sort-operator-3985eaf1-5af2-4f4a-bd0f-1c4b3f7e78c2","portID":"output-0"},"target":{"operatorID":"LineChart-operator-e3009841-32e4-4080-a6e4-f659762b3865","portID":"input-0"}}]}}